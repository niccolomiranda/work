!function(){class t{constructor(t,e,n,i){this.gridSize=t,this.gridColumns=e,this.gridRows=n,this.gridMin=i,this.rects=[],this.currentRects=[{x:0,y:0,w:this.gridColumns,h:this.gridRows}]}splitCurrentRect(){if(this.currentRects.length){const n=this.currentRects.shift(),i=n.w>n.h,o=i?n.w:n.h,r=i?"w":"h",s=i?"x":"y";if(o>2*this.gridMin){const i=(t=this.gridMin,e=o-this.gridMin,Math.floor(Math.random()*(e-t+1))+t),c=Object.assign({},n,{[r]:i}),a=Object.assign({},n,{[s]:n[s]+i,[r]:n[r]-i});this.currentRects.push(c,a)}else this.rects.push(n),this.splitCurrentRect()}var t,e}generateRects(){for(;this.currentRects.length;)this.splitCurrentRect();return this.rects}}const e=document.querySelector(".view");PIXI.Loader.shared.resources;let n,i,o,r,s,c,a,h=0,d=new PIXI.Point,l=new PIXI.Point;const u=50,f=3,w=20;let g,p,I,P,x,m,y,v,M,R,C,X,D,b;function E(){C.forEach((t,e)=>{const o=X[e];!function(t){return t.x*u+R.x<=n&&0<=(t.x+t.w)*u+R.x&&t.y*u+R.y<=i&&0<=(t.y+t.h)*u+R.y}(t)?(t.discovered&&!t.loaded&&(t.discovered=!1,t.controller.abort()),o.alpha>0&&(o.alpha-=.01)):(t.discovered||(t.discovered=!0,function t(e){const n=X[e],i=`https://source.unsplash.com/random/${n.width}x${n.height}`,o=C[e],{signal:r}=o.controller=new AbortController;fetch(i,{signal:r}).then(i=>{const r=i.url.split("?")[0];D[r]?t(e):(D[r]=!0,n.texture=PIXI.Texture.from(i.url),o.loaded=!0)}).catch(()=>{})}(e)),t.loaded&&o.alpha<1&&(o.alpha+=.01))})}function F(t){const{x:e,y:n}=t.data.global;h=1,d.set(e,n),l=s.uPointerDiff.clone()}function S(){h=0}function k(t){const{x:e,y:n}=t.data.global;h&&(c=l.x+(e-d.x),a=l.y+(n-d.y),c=c>0?Math.min(c,v+w):Math.max(c,-(v+m)),a=a>0?Math.min(a,M+w):Math.max(a,-(M+y)))}function z(){n=window.innerWidth,i=window.innerHeight,c=0,a=0,s={uResolution:new PIXI.Point(n,i),uPointerDiff:new PIXI.Point,uPointerDown:h},g=Math.ceil(n/u),p=Math.ceil(i/u),x=new t(u,I=5*g,P=5*p,f),m=Math.ceil(g*u-n),y=Math.ceil(p*u-i),v=I*u/2-g*u/2,M=P*u/2-p*u/2,C=x.generateRects(),X=[],D={},function(){(o=new PIXI.Application({view:e})).renderer.autoDensity=!0,o.renderer.resize(n,i);const t=document.getElementById("stageFragment").textContent,r=new PIXI.Filter(void 0,t,s);o.stage.filters=[r]}(),function(){(r=new PIXI.Sprite).width=n,r.height=i;const t=document.getElementById("backgroundFragment").textContent,e=new PIXI.Filter(void 0,t,s);r.filters=[e],o.stage.addChild(r)}(),R=new PIXI.Container,o.stage.addChild(R),function(){const t=new PIXI.Graphics;t.beginFill(0),C.forEach(e=>{const n=new PIXI.Sprite;n.x=e.x*u,n.y=e.y*u,n.width=e.w*u-w,n.height=e.h*u-w,n.alpha=0,X.push(n),t.drawRect(n.x,n.y,n.width,n.height)}),t.endFill(),R.addChild(t),X.forEach(t=>{R.addChild(t)})}(),o.stage.interactive=!0,o.stage.on("pointerdown",F).on("pointerup",S).on("pointerupoutside",S).on("pointermove",k),o.ticker.add(()=>{s.uPointerDown+=.075*(h-s.uPointerDown),s.uPointerDiff.x+=.2*(c-s.uPointerDiff.x),s.uPointerDiff.y+=.2*(a-s.uPointerDiff.y),R.x=s.uPointerDiff.x-v,R.y=s.uPointerDiff.y-M,E()})}window.addEventListener("resize",function(){b&&clearTimeout(b),b=setTimeout(()=>{o.ticker.stop(),o.stage.off("pointerdown",F).off("pointerup",S).off("pointerupoutside",S).off("pointermove",k),C.forEach(t=>{t.discovered&&!t.loaded&&t.controller.abort()}),z()},200)}),z()}();